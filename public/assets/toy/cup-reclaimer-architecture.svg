<?xml version="1.0" encoding="UTF-8"?>
<svg width="960" height="520" viewBox="0 0 960 520" xmlns="http://www.w3.org/2000/svg">
  <rect width="960" height="520" rx="24" fill="#ffffff" stroke="#e5e7eb"/>

  <!-- Device Cluster -->
  <rect x="24" y="90" width="200" height="320" rx="12" ry="12" fill="#f0f9ff" stroke="#38bdf8" stroke-width="2"/>
  <text x="124" y="120" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="16" fill="#0f172a">Arduino 스테이션</text>
  <rect x="44" y="150" width="160" height="60" rx="10" ry="10" fill="#ffffff" stroke="#38bdf8"/>
  <text x="124" y="182" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#0f172a">ESP Wi-Fi + 초음파 센서</text>
  <rect x="44" y="230" width="160" height="60" rx="10" ry="10" fill="#ffffff" stroke="#38bdf8"/>
  <text x="124" y="262" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#0f172a">상태 머신·디바운싱</text>
  <rect x="44" y="310" width="160" height="60" rx="10" ry="10" fill="#ffffff" stroke="#38bdf8"/>
  <text x="124" y="342" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#0f172a">MQTT QoS1 · TLS1.2</text>

  <!-- Cloudflare/AWS IoT Edge -->
  <rect x="244" y="140" width="200" height="220" rx="12" ry="12" fill="#fff7ed" stroke="#fb923c" stroke-width="2"/>
  <text x="344" y="170" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="16" fill="#7c2d12">AWS IoT Core</text>
  <rect x="264" y="200" width="160" height="60" rx="10" ry="10" fill="#ffffff" stroke="#fb923c"/>
  <text x="344" y="232" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#7c2d12">Device Registry · Shadow</text>
  <rect x="264" y="280" width="160" height="60" rx="10" ry="10" fill="#ffffff" stroke="#fb923c"/>
  <text x="344" y="312" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#7c2d12">IoT Rule SQL 검증</text>

  <!-- Serverless Processing -->
  <rect x="464" y="60" width="220" height="360" rx="12" ry="12" fill="#ecfdf5" stroke="#34d399" stroke-width="2"/>
  <text x="574" y="92" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="16" fill="#047857">AWS Lambda 처리</text>
  <rect x="484" y="120" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#34d399"/>
  <text x="574" y="152" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#065f46">중복 제거 (ts ±Δ)</text>
  <rect x="484" y="200" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#34d399"/>
  <text x="574" y="232" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#065f46">스테이션 메타 병합</text>
  <rect x="484" y="280" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#34d399"/>
  <text x="574" y="312" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#065f46">DynamoDB Upsert</text>
  <rect x="484" y="360" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#34d399"/>
  <text x="574" y="392" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#065f46">S3 원본 로그 보관</text>

  <!-- Data Stores & API -->
  <rect x="704" y="120" width="220" height="300" rx="12" ry="12" fill="#eef2ff" stroke="#6366f1" stroke-width="2"/>
  <text x="814" y="152" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="16" fill="#312e81">데이터 & 대시보드</text>
  <rect x="724" y="180" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#6366f1"/>
  <text x="814" y="212" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#1f2937">DynamoDB (PK: stationId, SK: ts)</text>
  <rect x="724" y="260" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#6366f1"/>
  <text x="814" y="292" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#1f2937">GSI date_bucket · geoHash</text>
  <rect x="724" y="340" width="180" height="60" rx="10" ry="10" fill="#ffffff" stroke="#6366f1"/>
  <text x="814" y="372" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#1f2937">API Gateway + React 대시보드</text>

  <!-- Analytics -->
  <rect x="724" y="420" width="180" height="50" rx="10" ry="10" fill="#ede9fe" stroke="#a855f7"/>
  <text x="814" y="448" text-anchor="middle" font-family="'Inter','Apple SD Gothic Neo',sans-serif" font-size="13" fill="#581c87">K-means 입지 분석 · 보정</text>

  <!-- sLM server not relevant here (none) -->

  <!-- Arrows -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
      <path d="M0 0 L10 5 L0 10 Z" fill="#0f172a"/>
    </marker>
  </defs>
  <line x1="224" y1="210" x2="244" y2="210" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="444" y1="240" x2="464" y2="240" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="684" y1="240" x2="704" y2="240" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="684" y1="320" x2="704" y2="320" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="574" y1="420" x2="574" y2="460" stroke="#0f172a" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="6 6"/>
</svg>
